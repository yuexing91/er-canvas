{"version":3,"file":"index.es.js","sources":["../src/Util.js","../src/ErBase.js","../src/ErTableField.js","../src/ErTable.js","../src/ErLine.js","../src/Er.js"],"sourcesContent":["function createElement(tag, attrs) {\r\n  let el = document.createElement(tag);\r\n  Object.keys(attrs).forEach(k => {\r\n    el.setAttribute(k, attrs[k]);\r\n  });\r\n  return el;\r\n}\r\n\r\nfunction hasClass(el, cls) {\r\n  return el.classList.contains(cls);\r\n}\r\n\r\nfunction getElementData(el, dataName) {\r\n  return el.dataset[dataName];\r\n}\r\n\r\nfunction onSegment(sp, ep, p) {\r\n  var xlen = 0;\r\n  var ylen = 0;\r\n  var len1 = 0; //sp到p的距离\r\n  var len2 = 0; //ep到p的距离\r\n  var len3 = 0; //sp到ep的距离\r\n\r\n  xlen = Math.abs(Math.pow(sp.x - p.x, 2));\r\n  ylen = Math.abs(Math.pow(sp.y - p.y, 2));\r\n  len1 = Math.sqrt(xlen + ylen);\r\n\r\n  xlen = Math.abs(Math.pow(ep.x - p.x, 2));\r\n  ylen = Math.abs(Math.pow(ep.y - p.y, 2));\r\n  len2 = Math.sqrt(xlen + ylen);\r\n\r\n  xlen = Math.abs(Math.pow(ep.x - sp.x, 2));\r\n  ylen = Math.abs(Math.pow(ep.y - sp.y, 2));\r\n  len3 = Math.sqrt(xlen + ylen);\r\n  var tmp = ( len1 + len2 ) - len3; //Math.round((len1 + len2)) - Math.round(len3);\r\n  if (tmp < 0.1) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction toUpperCaseFirst(str) {\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n\r\nexport {\r\n  createElement,\r\n  onSegment,\r\n  toUpperCaseFirst,\r\n  hasClass,\r\n  getElementData,\r\n};\r\n","class ErBase {\r\n  computedRect() {\r\n    this.rect = this.el.getBoundingClientRect();\r\n  }\r\n\r\n  removeClass(cls) {\r\n    this.el.classList.remove(cls)\r\n  }\r\n\r\n  addClass(cls){\r\n    this.el.classList.add(cls)\r\n  }\r\n\r\n}\r\n\r\nexport default ErBase;\r\n","import ErBase from './ErBase';\r\nimport { createElement } from './Util';\r\n\r\nclass ErTableField extends ErBase {\r\n  constructor(options, table) {\r\n    super();\r\n    this.type = 'ErTableField';\r\n    this.id = options.id;\r\n    this.tableId = table.id;\r\n    this.table = table;\r\n    this.options = options;\r\n    this.createEl();\r\n  }\r\n\r\n  createEl() {\r\n    this.el = createElement('div', {\r\n      'data-id': this.id,\r\n      class: 'er-table-field',\r\n    });\r\n    this.el.innerText = this.options.name;\r\n  }\r\n\r\n  getPoint() {\r\n    let rect = this.rect;\r\n    let tableRect = this.table.rect;\r\n    let rootRect = this.table.er.rect;\r\n\r\n    let y = rect.y + rect.height / 2;\r\n    y = Math.max(y, tableRect.y + 30);\r\n    y = Math.min(y, tableRect.y + tableRect.height-1);\r\n    y = y - rootRect.y;\r\n\r\n    let x = tableRect.x - rootRect.x;\r\n\r\n    return {\r\n      left: {\r\n        x,\r\n        y,\r\n      },\r\n      right: {\r\n        x: x + tableRect.width,\r\n        y,\r\n      },\r\n    };\r\n\r\n  }\r\n\r\n  toJSON() {\r\n    return Object.assign({}, this.options);\r\n  }\r\n\r\n}\r\n\r\nexport default ErTableField;\r\n","import { createElement } from './Util';\r\nimport ErTableField from './ErTableField';\r\nimport ErBase from './ErBase';\r\n\r\nclass ErTable extends ErBase {\r\n  constructor(options, er) {\r\n    super();\r\n    this.type = 'ErTable';\r\n    this.er = er;\r\n    this.id = options.id;\r\n    this.fields = [];\r\n    this.options = options;\r\n    this.createEl();\r\n    this.updateName();\r\n    this.updatePos(options.top, options.left);\r\n    options.fields.forEach(f => this.addField(f));\r\n  }\r\n\r\n  createEl() {\r\n    this.el = createElement('div', {\r\n      'data-id': this.id,\r\n      class: 'er-table',\r\n    });\r\n    this.elHeader = createElement('div', {\r\n      class: 'er-table-header',\r\n    });\r\n\r\n    this.elBody = createElement('div', {\r\n      class: 'er-table-body',\r\n    });\r\n\r\n    this.el.appendChild(this.elHeader);\r\n    this.el.appendChild(this.elBody);\r\n\r\n    this.el.querySelector('.er-table-body').addEventListener('scroll', (e) => {\r\n      this.er.repaint();\r\n    });\r\n\r\n  }\r\n\r\n  updateName() {\r\n    this.elHeader.innerText = this.options.name;\r\n  }\r\n\r\n  updatePos(top, left) {\r\n    this.top = top;\r\n    this.left = left;\r\n    this.el.style.top = top + 'px';\r\n    this.el.style.left = left + 'px';\r\n  }\r\n\r\n  addField(field) {\r\n    let erField = new ErTableField(field, this);\r\n    this.fields.push(erField);\r\n    this.elBody.appendChild(erField.el);\r\n  }\r\n\r\n  findField(id) {\r\n    return this.fields.find(f => f.id == id);\r\n  }\r\n\r\n  remove() {\r\n    this.er.removeTableLines(this.id);\r\n    this.el.parentElement.removeChild(this.el);\r\n  }\r\n\r\n  toJSON() {\r\n    return Object.assign({}, this.options, {\r\n      fields: this.fields.map(f => f.toJSON()),\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default ErTable;\r\n","import { onSegment } from './Util';\r\n\r\nclass ErLine {\r\n  constructor(form, to, options) {\r\n    this.type = 'ErLine';\r\n    this.form = form;\r\n    this.to = to;\r\n    this.options = options;\r\n  }\r\n\r\n  draw(ctx, color) {\r\n    this.drawLine(ctx, color);\r\n  }\r\n\r\n  drawLine(ctx, color) {\r\n    let form = this.form.getPoint();\r\n    let to = this.to.getPoint();\r\n    let x1, y1, x2, y2;\r\n    let sLine = 10;\r\n    let eArrow = 10;\r\n\r\n    let start = 'right';\r\n    let end = 'left';\r\n\r\n    if (form.right.x <= to.left.x) {\r\n\r\n    } else if (form.left.x > to.right.x) {\r\n      start = 'left';\r\n      end = 'right';\r\n      sLine = -10;\r\n      eArrow = -10;\r\n    } else if (form.left.x >= to.left.x && form.left.x <= to.right.x) {\r\n      start = 'left';\r\n      end = 'left';\r\n      eArrow = -10;\r\n      sLine = 10;\r\n    }\r\n\r\n    x1 = form[start].x;\r\n    y1 = form[start].y;\r\n\r\n    x2 = to[end].x;\r\n    y2 = to[end].y;\r\n\r\n    ctx.beginPath();\r\n    ctx.lineWidth = '2';\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x1 + eArrow, y1);\r\n    ctx.lineTo(x2 - sLine * 1.5, y2);\r\n    ctx.lineTo(x2 - sLine, y2);\r\n    ctx.strokeStyle = color || '#000';\r\n    ctx.stroke();\r\n\r\n    ctx.beginPath();\r\n    ctx.lineTo(x2 - sLine, y2 - 4);\r\n    ctx.lineTo(x2 - sLine, y2 + 4);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.closePath();\r\n    ctx.fillStyle = color || '#000';\r\n    ctx.fill();\r\n\r\n    this.formPoint = {\r\n      x: x1 + eArrow, y: y1,\r\n    };\r\n    this.toPoint = {\r\n      x: x2 - sLine * 1.5, y: y2,\r\n    };\r\n  }\r\n\r\n  inLine(p) {\r\n    return onSegment(this.formPoint, this.toPoint, p);\r\n  }\r\n\r\n  toJSON() {\r\n    return Object.assign({}, this.options, {\r\n      form: this.form.id,\r\n      to: this.to.id,\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default ErLine;\r\n","import { createElement, getElementData, hasClass, toUpperCaseFirst } from './Util';\r\nimport ErBase from './ErBase';\r\nimport ErTable from './ErTable';\r\nimport ErLine from './ErLine';\r\n\r\nclass Er extends ErBase {\r\n  constructor(el, options) {\r\n    super();\r\n    this.el = el;\r\n    this.options = options;\r\n    this.tables = [];\r\n    this.lines = [];\r\n    this._curSelect = null;\r\n    this.tempLine = null;\r\n    this.createCanvas();\r\n    el.appendChild(this.canvas);\r\n    options?.tables.forEach(t => this.addTable(t));\r\n    options?.lines.forEach(l => this.addLine(l));\r\n    this.ctx = this.canvas.getContext('2d');\r\n    this.bindEvent();\r\n    this.repaint();\r\n  }\r\n\r\n  computedRect() {\r\n    super.computedRect();\r\n    this.rect.x -= this.el.scrollLeft;\r\n    this.rect.y -= this.el.scrollTop;\r\n  }\r\n\r\n  createCanvas() {\r\n    this.canvas = createElement('canvas', {\r\n      width: this.options.width || 900,\r\n      height: this.options.height || 600,\r\n    });\r\n  }\r\n\r\n  resizeCanvas(width, height) {\r\n    this.canvas.width = width;\r\n    this.canvas.height = height;\r\n  }\r\n\r\n  addTable(table) {\r\n    let erTable = new ErTable(table, this);\r\n    this.tables.push(erTable);\r\n    this.el.appendChild(erTable.el);\r\n  }\r\n\r\n  addLine(line) {\r\n    let form = this.findField(line.form);\r\n    let to = this.findField(line.to);\r\n\r\n    if (form.tableId == to.tableId) {\r\n      return;\r\n    }\r\n\r\n    let t = new ErLine(form, to, line);\r\n\r\n    if (this.findLine(t)) return;\r\n\r\n    this.lines.push(t);\r\n    this.repaint();\r\n  }\r\n\r\n  findTable(id) {\r\n    return this.tables.find(t => t.id == id);\r\n  }\r\n\r\n  findField(id) {\r\n    let field;\r\n    this.tables.find(t => field = t.findField(id));\r\n    return field;\r\n  }\r\n\r\n  findLineByPoint(p) {\r\n    return this.lines.find(line => line.inLine(p));\r\n  }\r\n\r\n  findLine(line) {\r\n    return this.lines.find(l => line === l || ( line.form.id == l.form.id && line.to.id == l.to.id ));\r\n  }\r\n\r\n  findLineById(form, to) {\r\n    return this.lines.find(l => form == l.form.id && to == l.to.id);\r\n  }\r\n\r\n  findLineByTableId(tableId) {\r\n    return this.lines.filter(l => l.form.tableId == tableId || l.to.tableId == tableId);\r\n  }\r\n\r\n  clearAll() {\r\n    this.lines = [];\r\n    this.tables.forEach(t => t.remove());\r\n    this.tables = [];\r\n    this.repaint();\r\n  }\r\n\r\n  removeTable(tableId) {\r\n    let table = this.findTable(tableId);\r\n    let i = this.tables.indexOf(table);\r\n    if (i > -1) {\r\n      this.tables.splice(i, 1);\r\n      table.remove();\r\n    }\r\n\r\n  }\r\n\r\n  removeTableLines(tableId) {\r\n    this.findLineByTableId(tableId).forEach(l => this.removeLine(l));\r\n  }\r\n\r\n  removeLine(line) {\r\n    let l = this.findLine(line);\r\n    let index = this.lines.indexOf(l);\r\n    if (index > -1) {\r\n      this.lines.splice(index, 1);\r\n      this.repaint();\r\n    }\r\n  }\r\n\r\n  trigger(name, ...args) {\r\n    let event = this.options['on' + toUpperCaseFirst(name)];\r\n    if (event) {\r\n      event.apply(null, args);\r\n    }\r\n  }\r\n\r\n  bindEvent() {\r\n    this.bindKeyborad();\r\n    this.bindSelectTableEvent();\r\n    this.bindMoveTableEvent();\r\n    this.bindDrawLineEvent();\r\n    this.bindLineEvent();\r\n    this.bindContextMenuEvent();\r\n  }\r\n\r\n  bindContextMenuEvent() {\r\n    this.el.addEventListener('contextmenu', (e) => {\r\n      this.trigger('contextmenu', e, this._curSelect);\r\n      e.preventDefault();\r\n    });\r\n  }\r\n\r\n  bindKeyborad() {\r\n    this.el.addEventListener('keyup', (e) => {\r\n      if (e.keyCode == 46) {\r\n        let eventName = '';\r\n        if (this._curSelect instanceof ErTable) {\r\n          this.removeTable(this._curSelect.id);\r\n          eventName = 'removeTable';\r\n        } else if (this._curSelect instanceof ErLine) {\r\n          this.removeLine(this._curSelect);\r\n          eventName = 'removeLine';\r\n        }\r\n        let curSelect = this._curSelect;\r\n        this.curSelect = null;\r\n        this.repaint();\r\n        this.trigger(eventName, curSelect);\r\n      }\r\n    });\r\n  }\r\n\r\n  bindSelectTableEvent() {\r\n    const selectFn = (e) => {\r\n      if (hasClass(e.target, 'er-table-header')) {\r\n        let table = this.findTable(getElementData(e.target.parentElement, 'id'));\r\n        this.curSelect = table;\r\n        this.repaint();\r\n        this.trigger('selectTable', table);\r\n      }\r\n    };\r\n    this.el.addEventListener('contextmenu', selectFn);\r\n    this.el.addEventListener('click', selectFn);\r\n  }\r\n\r\n  bindMoveTableEvent() {\r\n    let point = {};\r\n    let tableOrigin = {};\r\n    let table = null;\r\n\r\n    this.el.addEventListener('mousedown', (e) => {\r\n      if (hasClass(e.target, 'er-table-header')) {\r\n        table = this.findTable(getElementData(e.target.parentElement, 'id'));\r\n        point = { x: e.pageX, y: e.pageY };\r\n        tableOrigin = { x: table.left, y: table.top };\r\n      }\r\n    });\r\n\r\n    this.el.addEventListener('mousemove', e => {\r\n      if (!table) return;\r\n      let x = e.pageX - point.x;\r\n      let y = e.pageY - point.y;\r\n      table.updatePos(Math.max(tableOrigin.y + y, 0), Math.max(tableOrigin.x + x, 0));\r\n      this.repaint();\r\n    });\r\n\r\n    this.el.addEventListener('mouseup', e => {\r\n      if (!table) return;\r\n      table = null;\r\n      tableOrigin = {};\r\n      point = {};\r\n      this.repaint();\r\n    });\r\n\r\n  }\r\n\r\n  bindDrawLineEvent() {\r\n    let formField = null;\r\n\r\n    this.el.addEventListener('mousedown', (e) => {\r\n      if (hasClass(e.target, 'er-table-field')) {\r\n        formField = this.findField(getElementData(e.target, 'id'));\r\n      }\r\n    });\r\n\r\n    this.el.addEventListener('mousemove', e => {\r\n      if (!formField) return;\r\n      this.tempLine = new ErLine(formField, {\r\n        getPoint: () => {\r\n          let p = { x: e.clientX - this.rect.x, y: e.clientY - this.rect.y };\r\n          return {\r\n            left: p,\r\n            right: p,\r\n          };\r\n        },\r\n      });\r\n      this.repaint();\r\n    });\r\n\r\n    this.el.addEventListener('mouseup', e => {\r\n      if (!formField) return;\r\n      if (hasClass(e.target, 'er-table-field')) {\r\n        let toField = this.findField(getElementData(e.target, 'id'));\r\n        this.addLine({\r\n          form: formField.id,\r\n          to: toField.id,\r\n        });\r\n      }\r\n      formField = null;\r\n      this.tempLine = null;\r\n      this.repaint();\r\n    });\r\n  }\r\n\r\n  bindLineEvent() {\r\n    this.canvas.addEventListener('mousemove', e => {\r\n      let l = this.findLineByPoint({ x: e.offsetX, y: e.offsetY });\r\n      if (this.hoverLine != l) {\r\n        this.hoverLine = l;\r\n        this.repaint();\r\n      }\r\n    });\r\n\r\n    const selectLineFn = e => {\r\n      let l = this.findLineByPoint({ x: e.offsetX, y: e.offsetY });\r\n      this.curSelect = l;\r\n      this.repaint();\r\n      this.trigger('selectLine', l);\r\n    };\r\n\r\n    this.canvas.addEventListener('click', selectLineFn);\r\n    this.canvas.addEventListener('contextmenu', selectLineFn);\r\n  }\r\n\r\n  repaint() {\r\n    if (this._paint) return;\r\n    this._paint = true;\r\n    setTimeout(() => {\r\n      this._paint = false;\r\n      this.reComputedAllRect();\r\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n      this.lines.forEach(line => this.drawLine(line));\r\n      if (this.tempLine) {\r\n        this.tempLine.draw(this.ctx);\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  reComputedAllRect() {\r\n    this.computedRect();\r\n    this.tables.forEach(t => {\r\n      t.computedRect();\r\n      t.fields.forEach(f => f.computedRect());\r\n    });\r\n  }\r\n\r\n  drawLine(line) {\r\n    let color = '#000';\r\n    if (this.curSelect == line) {\r\n      color = 'red';\r\n    }\r\n    if (this.hoverLine == line) {\r\n      color = '#dc2323';\r\n    }\r\n\r\n    line.draw(this.ctx, color);\r\n  }\r\n\r\n  get curSelect() {\r\n    return this._curSelect;\r\n  }\r\n\r\n  set curSelect(v) {\r\n    if (this._curSelect?.type == 'ErTable') {\r\n      this._curSelect.removeClass('er-table-selected');\r\n    }\r\n    if (v?.type == 'ErTable') {\r\n      v.addClass('er-table-selected');\r\n    }\r\n    this._curSelect = v;\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      width: this.options.width,\r\n      height: this.options.height,\r\n      tables: this.tables.map(t => t.toJSON()),\r\n      lines: this.lines.map(l => l.toJSON()),\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport default Er;\r\n"],"names":["createElement","tag","attrs","el","document","Object","keys","forEach","k","setAttribute","hasClass","cls","classList","contains","getElementData","dataName","dataset","onSegment","sp","ep","p","xlen","ylen","len1","len2","len3","Math","abs","pow","x","y","sqrt","tmp","toUpperCaseFirst","str","charAt","toUpperCase","slice","ErBase","computedRect","rect","getBoundingClientRect","removeClass","remove","addClass","add","ErTableField","options","table","type","id","tableId","createEl","innerText","name","getPoint","tableRect","rootRect","er","height","max","min","left","right","width","toJSON","assign","ErTable","fields","updateName","updatePos","top","f","addField","elHeader","elBody","appendChild","querySelector","addEventListener","e","repaint","style","field","erField","push","findField","find","removeTableLines","parentElement","removeChild","map","ErLine","form","to","draw","ctx","color","drawLine","x1","y1","x2","y2","sLine","eArrow","start","end","beginPath","lineWidth","moveTo","lineTo","strokeStyle","stroke","closePath","fillStyle","fill","formPoint","toPoint","inLine","Er","tables","lines","_curSelect","tempLine","createCanvas","canvas","t","addTable","l","addLine","getContext","bindEvent","scrollLeft","scrollTop","resizeCanvas","erTable","line","findLine","findTable","findLineByPoint","findLineById","findLineByTableId","filter","clearAll","removeTable","i","indexOf","splice","removeLine","index","trigger","event","args","apply","bindKeyborad","bindSelectTableEvent","bindMoveTableEvent","bindDrawLineEvent","bindLineEvent","bindContextMenuEvent","preventDefault","keyCode","eventName","curSelect","selectFn","target","point","tableOrigin","pageX","pageY","formField","clientX","clientY","toField","offsetX","offsetY","hoverLine","selectLineFn","_paint","setTimeout","reComputedAllRect","clearRect","v"],"mappings":"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"}