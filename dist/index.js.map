{"version":3,"file":"index.js","sources":["../src/Util.js","../src/ErBase.js","../src/ErTableField.js","../src/ErTable.js","../src/ErLine.js","../src/Er.js"],"sourcesContent":["function createElement(tag, attrs) {\r\n  let el = document.createElement(tag);\r\n  Object.keys(attrs).forEach(k => {\r\n    el.setAttribute(k, attrs[k]);\r\n  });\r\n  return el;\r\n}\r\n\r\nfunction hasClass(el, cls) {\r\n  return el.classList.contains(cls);\r\n}\r\n\r\nfunction getElementData(el, dataName) {\r\n  return el.dataset[dataName];\r\n}\r\n\r\nfunction onSegment(sp, ep, p) {\r\n  var xlen = 0;\r\n  var ylen = 0;\r\n  var len1 = 0; //sp到p的距离\r\n  var len2 = 0; //ep到p的距离\r\n  var len3 = 0; //sp到ep的距离\r\n\r\n  xlen = Math.abs(Math.pow(sp.x - p.x, 2));\r\n  ylen = Math.abs(Math.pow(sp.y - p.y, 2));\r\n  len1 = Math.sqrt(xlen + ylen);\r\n\r\n  xlen = Math.abs(Math.pow(ep.x - p.x, 2));\r\n  ylen = Math.abs(Math.pow(ep.y - p.y, 2));\r\n  len2 = Math.sqrt(xlen + ylen);\r\n\r\n  xlen = Math.abs(Math.pow(ep.x - sp.x, 2));\r\n  ylen = Math.abs(Math.pow(ep.y - sp.y, 2));\r\n  len3 = Math.sqrt(xlen + ylen);\r\n  var tmp = ( len1 + len2 ) - len3; //Math.round((len1 + len2)) - Math.round(len3);\r\n  if (tmp < 0.1) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction toUpperCaseFirst(str) {\r\n  return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\n\r\nexport {\r\n  createElement,\r\n  onSegment,\r\n  toUpperCaseFirst,\r\n  hasClass,\r\n  getElementData,\r\n};\r\n","class ErBase {\r\n  computedRect() {\r\n    this.rect = this.el.getBoundingClientRect();\r\n  }\r\n\r\n  removeClass(cls) {\r\n    this.el.classList.remove(cls)\r\n  }\r\n\r\n  addClass(cls){\r\n    this.el.classList.add(cls)\r\n  }\r\n\r\n}\r\n\r\nexport default ErBase;\r\n","import ErBase from './ErBase';\r\nimport { createElement } from './Util';\r\n\r\nclass ErTableField extends ErBase {\r\n  constructor(options, table) {\r\n    super();\r\n    this.type = 'ErTableField';\r\n    this.id = options.id;\r\n    this.tableId = table.id;\r\n    this.table = table;\r\n    this.options = options;\r\n    this.createEl();\r\n  }\r\n\r\n  createEl() {\r\n    this.el = createElement('div', {\r\n      'data-id': this.id,\r\n      class: 'er-table-field',\r\n    });\r\n    this.el.innerText = this.options.name;\r\n  }\r\n\r\n  getPoint() {\r\n    let rect = this.rect;\r\n    let tableRect = this.table.rect;\r\n    let rootRect = this.table.er.rect;\r\n\r\n    let y = rect.y + rect.height / 2;\r\n    y = Math.max(y, tableRect.y + 30);\r\n    y = Math.min(y, tableRect.y + tableRect.height-1);\r\n    y = y - rootRect.y;\r\n\r\n    let x = tableRect.x - rootRect.x;\r\n\r\n    return {\r\n      left: {\r\n        x,\r\n        y,\r\n      },\r\n      right: {\r\n        x: x + tableRect.width,\r\n        y,\r\n      },\r\n    };\r\n\r\n  }\r\n\r\n  toJSON() {\r\n    return Object.assign({}, this.options);\r\n  }\r\n\r\n}\r\n\r\nexport default ErTableField;\r\n","import { createElement } from './Util';\r\nimport ErTableField from './ErTableField';\r\nimport ErBase from './ErBase';\r\n\r\nclass ErTable extends ErBase {\r\n  constructor(options, er) {\r\n    super();\r\n    this.type = 'ErTable';\r\n    this.er = er;\r\n    this.id = options.id;\r\n    this.fields = [];\r\n    this.options = options;\r\n    this.createEl();\r\n    this.updateName();\r\n    this.updatePos(options.top, options.left);\r\n    options.fields.forEach(f => this.addField(f));\r\n  }\r\n\r\n  createEl() {\r\n    this.el = createElement('div', {\r\n      'data-id': this.id,\r\n      class: 'er-table',\r\n    });\r\n    this.elHeader = createElement('div', {\r\n      class: 'er-table-header',\r\n    });\r\n\r\n    this.elBody = createElement('div', {\r\n      class: 'er-table-body',\r\n    });\r\n\r\n    this.el.appendChild(this.elHeader);\r\n    this.el.appendChild(this.elBody);\r\n\r\n    this.el.querySelector('.er-table-body').addEventListener('scroll', (e) => {\r\n      this.er.repaint();\r\n    });\r\n\r\n  }\r\n\r\n  updateName() {\r\n    this.elHeader.innerText = this.options.name;\r\n  }\r\n\r\n  updatePos(top, left) {\r\n    this.top = top;\r\n    this.left = left;\r\n    this.el.style.top = top + 'px';\r\n    this.el.style.left = left + 'px';\r\n  }\r\n\r\n  addField(field) {\r\n    let erField = new ErTableField(field, this);\r\n    this.fields.push(erField);\r\n    this.elBody.appendChild(erField.el);\r\n  }\r\n\r\n  findField(id) {\r\n    return this.fields.find(f => f.id == id);\r\n  }\r\n\r\n  remove() {\r\n    this.er.removeTableLines(this.id);\r\n    this.el.parentElement.removeChild(this.el);\r\n  }\r\n\r\n  toJSON() {\r\n    return Object.assign({}, this.options, {\r\n      fields: this.fields.map(f => f.toJSON()),\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default ErTable;\r\n","import { onSegment } from './Util';\r\n\r\nclass ErLine {\r\n  constructor(form, to, options) {\r\n    this.type = 'ErLine';\r\n    this.form = form;\r\n    this.to = to;\r\n    this.options = options;\r\n  }\r\n\r\n  draw(ctx, color) {\r\n    this.drawLine(ctx, color);\r\n  }\r\n\r\n  drawLine(ctx, color) {\r\n    let form = this.form.getPoint();\r\n    let to = this.to.getPoint();\r\n    let x1, y1, x2, y2;\r\n    let sLine = 10;\r\n    let eArrow = 10;\r\n\r\n    let start = 'right';\r\n    let end = 'left';\r\n\r\n    if (form.right.x <= to.left.x) {\r\n\r\n    } else if (form.left.x > to.right.x) {\r\n      start = 'left';\r\n      end = 'right';\r\n      sLine = -10;\r\n      eArrow = -10;\r\n    } else if (form.left.x >= to.left.x && form.left.x <= to.right.x) {\r\n      start = 'left';\r\n      end = 'left';\r\n      eArrow = -10;\r\n      sLine = 10;\r\n    }\r\n\r\n    x1 = form[start].x;\r\n    y1 = form[start].y;\r\n\r\n    x2 = to[end].x;\r\n    y2 = to[end].y;\r\n\r\n    ctx.beginPath();\r\n    ctx.lineWidth = '2';\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x1 + eArrow, y1);\r\n    ctx.lineTo(x2 - sLine * 1.5, y2);\r\n    ctx.lineTo(x2 - sLine, y2);\r\n    ctx.strokeStyle = color || '#000';\r\n    ctx.stroke();\r\n\r\n    ctx.beginPath();\r\n    ctx.lineTo(x2 - sLine, y2 - 4);\r\n    ctx.lineTo(x2 - sLine, y2 + 4);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.closePath();\r\n    ctx.fillStyle = color || '#000';\r\n    ctx.fill();\r\n\r\n    this.formPoint = {\r\n      x: x1 + eArrow, y: y1,\r\n    };\r\n    this.toPoint = {\r\n      x: x2 - sLine * 1.5, y: y2,\r\n    };\r\n  }\r\n\r\n  inLine(p) {\r\n    return onSegment(this.formPoint, this.toPoint, p);\r\n  }\r\n\r\n  toJSON() {\r\n    return Object.assign({}, this.options, {\r\n      form: this.form.id,\r\n      to: this.to.id,\r\n    });\r\n  }\r\n\r\n}\r\n\r\nexport default ErLine;\r\n","import { createElement, getElementData, hasClass, toUpperCaseFirst } from './Util';\r\nimport ErBase from './ErBase';\r\nimport ErTable from './ErTable';\r\nimport ErLine from './ErLine';\r\n\r\nclass Er extends ErBase {\r\n  constructor(el, options) {\r\n    super();\r\n    this.el = el;\r\n    this.options = options;\r\n    this.tables = [];\r\n    this.lines = [];\r\n    this._curSelect = null;\r\n    this.tempLine = null;\r\n    this.createCanvas();\r\n    el.appendChild(this.canvas);\r\n    options?.tables.forEach(t => this.addTable(t));\r\n    options?.lines.forEach(l => this.addLine(l));\r\n    this.ctx = this.canvas.getContext('2d');\r\n    this.bindEvent();\r\n    this.repaint();\r\n  }\r\n\r\n  computedRect() {\r\n    super.computedRect();\r\n    this.rect.x -= this.el.scrollLeft;\r\n    this.rect.y -= this.el.scrollTop;\r\n  }\r\n\r\n  createCanvas() {\r\n    this.canvas = createElement('canvas', {\r\n      width: this.options.width || 900,\r\n      height: this.options.height || 600,\r\n    });\r\n  }\r\n\r\n  resizeCanvas(width, height) {\r\n    this.canvas.width = width;\r\n    this.canvas.height = height;\r\n  }\r\n\r\n  addTable(table) {\r\n    let erTable = new ErTable(table, this);\r\n    this.tables.push(erTable);\r\n    this.el.appendChild(erTable.el);\r\n  }\r\n\r\n  addLine(line) {\r\n    let form = this.findField(line.form);\r\n    let to = this.findField(line.to);\r\n\r\n    if (form.tableId == to.tableId) {\r\n      return;\r\n    }\r\n\r\n    let t = new ErLine(form, to, line);\r\n\r\n    if (this.findLine(t)) return;\r\n\r\n    this.lines.push(t);\r\n    this.repaint();\r\n  }\r\n\r\n  findTable(id) {\r\n    return this.tables.find(t => t.id == id);\r\n  }\r\n\r\n  findField(id) {\r\n    let field;\r\n    this.tables.find(t => field = t.findField(id));\r\n    return field;\r\n  }\r\n\r\n  findLineByPoint(p) {\r\n    return this.lines.find(line => line.inLine(p));\r\n  }\r\n\r\n  findLine(line) {\r\n    return this.lines.find(l => line === l || ( line.form.id == l.form.id && line.to.id == l.to.id ));\r\n  }\r\n\r\n  findLineById(form, to) {\r\n    return this.lines.find(l => form == l.form.id && to == l.to.id);\r\n  }\r\n\r\n  findLineByTableId(tableId) {\r\n    return this.lines.filter(l => l.form.tableId == tableId || l.to.tableId == tableId);\r\n  }\r\n\r\n  clearAll() {\r\n    this.lines = [];\r\n    this.tables.forEach(t => t.remove());\r\n    this.tables = [];\r\n    this.repaint();\r\n  }\r\n\r\n  removeTable(tableId) {\r\n    let table = this.findTable(tableId);\r\n    let i = this.tables.indexOf(table);\r\n    if (i > -1) {\r\n      this.tables.splice(i, 1);\r\n      table.remove();\r\n    }\r\n\r\n  }\r\n\r\n  removeTableLines(tableId) {\r\n    this.findLineByTableId(tableId).forEach(l => this.removeLine(l));\r\n  }\r\n\r\n  removeLine(line) {\r\n    let l = this.findLine(line);\r\n    let index = this.lines.indexOf(l);\r\n    if (index > -1) {\r\n      this.lines.splice(index, 1);\r\n      this.repaint();\r\n    }\r\n  }\r\n\r\n  trigger(name, ...args) {\r\n    let event = this.options['on' + toUpperCaseFirst(name)];\r\n    if (event) {\r\n      event.apply(null, args);\r\n    }\r\n  }\r\n\r\n  bindEvent() {\r\n    this.bindKeyborad();\r\n    this.bindSelectTableEvent();\r\n    this.bindMoveTableEvent();\r\n    this.bindDrawLineEvent();\r\n    this.bindLineEvent();\r\n    this.bindContextMenuEvent();\r\n  }\r\n\r\n  bindContextMenuEvent() {\r\n    this.el.addEventListener('contextmenu', (e) => {\r\n      this.trigger('contextmenu', e, this._curSelect);\r\n      e.preventDefault();\r\n    });\r\n  }\r\n\r\n  bindKeyborad() {\r\n    this.el.addEventListener('keyup', (e) => {\r\n      if (e.keyCode == 46) {\r\n        let eventName = '';\r\n        if (this._curSelect instanceof ErTable) {\r\n          this.removeTable(this._curSelect.id);\r\n          eventName = 'removeTable';\r\n        } else if (this._curSelect instanceof ErLine) {\r\n          this.removeLine(this._curSelect);\r\n          eventName = 'removeLine';\r\n        }\r\n        let curSelect = this._curSelect;\r\n        this.curSelect = null;\r\n        this.repaint();\r\n        this.trigger(eventName, curSelect);\r\n      }\r\n    });\r\n  }\r\n\r\n  bindSelectTableEvent() {\r\n    const selectFn = (e) => {\r\n      if (hasClass(e.target, 'er-table-header')) {\r\n        let table = this.findTable(getElementData(e.target.parentElement, 'id'));\r\n        this.curSelect = table;\r\n        this.repaint();\r\n        this.trigger('selectTable', table);\r\n      }\r\n    };\r\n    this.el.addEventListener('contextmenu', selectFn);\r\n    this.el.addEventListener('click', selectFn);\r\n  }\r\n\r\n  bindMoveTableEvent() {\r\n    let point = {};\r\n    let tableOrigin = {};\r\n    let table = null;\r\n\r\n    this.el.addEventListener('mousedown', (e) => {\r\n      if (hasClass(e.target, 'er-table-header')) {\r\n        table = this.findTable(getElementData(e.target.parentElement, 'id'));\r\n        point = { x: e.pageX, y: e.pageY };\r\n        tableOrigin = { x: table.left, y: table.top };\r\n      }\r\n    });\r\n\r\n    this.el.addEventListener('mousemove', e => {\r\n      if (!table) return;\r\n      let x = e.pageX - point.x;\r\n      let y = e.pageY - point.y;\r\n      table.updatePos(Math.max(tableOrigin.y + y, 0), Math.max(tableOrigin.x + x, 0));\r\n      this.repaint();\r\n    });\r\n\r\n    this.el.addEventListener('mouseup', e => {\r\n      if (!table) return;\r\n      table = null;\r\n      tableOrigin = {};\r\n      point = {};\r\n      this.repaint();\r\n    });\r\n\r\n  }\r\n\r\n  bindDrawLineEvent() {\r\n    let formField = null;\r\n\r\n    this.el.addEventListener('mousedown', (e) => {\r\n      if (hasClass(e.target, 'er-table-field')) {\r\n        formField = this.findField(getElementData(e.target, 'id'));\r\n      }\r\n    });\r\n\r\n    this.el.addEventListener('mousemove', e => {\r\n      if (!formField) return;\r\n      this.tempLine = new ErLine(formField, {\r\n        getPoint: () => {\r\n          let p = { x: e.clientX - this.rect.x, y: e.clientY - this.rect.y };\r\n          return {\r\n            left: p,\r\n            right: p,\r\n          };\r\n        },\r\n      });\r\n      this.repaint();\r\n    });\r\n\r\n    this.el.addEventListener('mouseup', e => {\r\n      if (!formField) return;\r\n      if (hasClass(e.target, 'er-table-field')) {\r\n        let toField = this.findField(getElementData(e.target, 'id'));\r\n        this.addLine({\r\n          form: formField.id,\r\n          to: toField.id,\r\n        });\r\n      }\r\n      formField = null;\r\n      this.tempLine = null;\r\n      this.repaint();\r\n    });\r\n  }\r\n\r\n  bindLineEvent() {\r\n    this.canvas.addEventListener('mousemove', e => {\r\n      let l = this.findLineByPoint({ x: e.offsetX, y: e.offsetY });\r\n      if (this.hoverLine != l) {\r\n        this.hoverLine = l;\r\n        this.repaint();\r\n      }\r\n    });\r\n\r\n    const selectLineFn = e => {\r\n      let l = this.findLineByPoint({ x: e.offsetX, y: e.offsetY });\r\n      this.curSelect = l;\r\n      this.repaint();\r\n      this.trigger('selectLine', l);\r\n    };\r\n\r\n    this.canvas.addEventListener('click', selectLineFn);\r\n    this.canvas.addEventListener('contextmenu', selectLineFn);\r\n  }\r\n\r\n  repaint() {\r\n    if (this._paint) return;\r\n    this._paint = true;\r\n    setTimeout(() => {\r\n      this._paint = false;\r\n      this.reComputedAllRect();\r\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\r\n      this.lines.forEach(line => this.drawLine(line));\r\n      if (this.tempLine) {\r\n        this.tempLine.draw(this.ctx);\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  reComputedAllRect() {\r\n    this.computedRect();\r\n    this.tables.forEach(t => {\r\n      t.computedRect();\r\n      t.fields.forEach(f => f.computedRect());\r\n    });\r\n  }\r\n\r\n  drawLine(line) {\r\n    let color = '#000';\r\n    if (this.curSelect == line) {\r\n      color = 'red';\r\n    }\r\n    if (this.hoverLine == line) {\r\n      color = '#dc2323';\r\n    }\r\n\r\n    line.draw(this.ctx, color);\r\n  }\r\n\r\n  get curSelect() {\r\n    return this._curSelect;\r\n  }\r\n\r\n  set curSelect(v) {\r\n    if (this._curSelect?.type == 'ErTable') {\r\n      this._curSelect.removeClass('er-table-selected');\r\n    }\r\n    if (v?.type == 'ErTable') {\r\n      v.addClass('er-table-selected');\r\n    }\r\n    this._curSelect = v;\r\n  }\r\n\r\n  toJSON() {\r\n    return {\r\n      width: this.options.width,\r\n      height: this.options.height,\r\n      tables: this.tables.map(t => t.toJSON()),\r\n      lines: this.lines.map(l => l.toJSON()),\r\n    };\r\n  }\r\n\r\n}\r\n\r\nexport default Er;\r\n"],"names":["createElement","tag","attrs","el","document","Object","keys","forEach","k","setAttribute","hasClass","cls","classList","contains","getElementData","dataName","dataset","onSegment","sp","ep","p","xlen","ylen","len1","len2","len3","Math","abs","pow","x","y","sqrt","tmp","toUpperCaseFirst","str","charAt","toUpperCase","slice","ErBase","computedRect","rect","getBoundingClientRect","removeClass","remove","addClass","add","ErTableField","options","table","type","id","tableId","createEl","innerText","name","getPoint","tableRect","rootRect","er","height","max","min","left","right","width","toJSON","assign","ErTable","fields","updateName","updatePos","top","f","addField","elHeader","elBody","appendChild","querySelector","addEventListener","e","repaint","style","field","erField","push","findField","find","removeTableLines","parentElement","removeChild","map","ErLine","form","to","draw","ctx","color","drawLine","x1","y1","x2","y2","sLine","eArrow","start","end","beginPath","lineWidth","moveTo","lineTo","strokeStyle","stroke","closePath","fillStyle","fill","formPoint","toPoint","inLine","Er","tables","lines","_curSelect","tempLine","createCanvas","canvas","t","addTable","l","addLine","getContext","bindEvent","scrollLeft","scrollTop","resizeCanvas","erTable","line","findLine","findTable","findLineByPoint","findLineById","findLineByTableId","filter","clearAll","removeTable","i","indexOf","splice","removeLine","index","trigger","event","args","apply","bindKeyborad","bindSelectTableEvent","bindMoveTableEvent","bindDrawLineEvent","bindLineEvent","bindContextMenuEvent","preventDefault","keyCode","eventName","curSelect","selectFn","target","point","tableOrigin","pageX","pageY","formField","clientX","clientY","toField","offsetX","offsetY","hoverLine","selectLineFn","_paint","setTimeout","reComputedAllRect","clearRect","v"],"mappings":"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"}